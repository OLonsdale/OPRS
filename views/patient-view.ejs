<% if (patient) { %>

  <a href="/patient/edit/<%= patient.id %>" class="btn btn-primary mt-3 mb-1">Edit Patient</a>
  <a href="/patient/archive/<%= patient.id %>" class="btn btn-outline-danger mt-3 mb-1">Archive Patient</a>
  <div class="accordion" id="details">
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingOne">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          General
        </button>
      </h2>
      <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#details">
        <div class="accordion-body">
          <table class="table">
            <tr>
              <td>ID</td>
              <td><%= patient._id %></td>
            </tr>
            <tr>
              <td>First Name</td>
              <td><%= patient.firstName %></td>
            </tr>
            <tr>
              <td>Middle Name</td>
              <td><%= patient.middleName %></td>
            </tr>
            <tr>
              <td>Last Name</td>
              <td><%= patient.lastName %></td>
            </tr>
            <tr>
              <td>Gender</td>
              <td><%= patient.gender %></td>
            </tr>
            <tr>
              <td>Date of Birth</td>
              <td><%= patient.dateOfBirth %></td>
            </tr>
            <tr>
              <td>NHS Number</td>
              <td><%= patient.NHSNumber %></td>
            </tr>
            <tr>
              <td>Patient Type</td>
              <td><%= patient.patientType %></td>
            </tr>
            <tr>
              <td>Date Added</td>
              <td><%= patient.dateAdded.toLocaleDateString('en-GB') %></td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingTwo">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          Contact Details
        </button>
      </h2>
      <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#details">
        <div class="accordion-body">
          <table class="table">
            <tr>
              <td>Email</td>
              <td><%= patient.email %></td>
            </tr>
            <tr>
              <td>Landline</td>
              <td><%= patient.phoneLandline %></td>
            </tr>
            <tr>
              <td>Mobile</td>
              <td><%= patient.phoneMobile %></td>
            </tr>
            <tr>
              <td>GP Name</td>
              <td><%= patient.GPName %></td>
            </tr>
            <tr>
              <td>GP Address</td>
              <td><textarea aria-readonly="true" rows="5" style="resize: none;" class="form-control"><%= patient.GPAddress %></textarea></td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingThree">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          Address
        </button>
      </h2>
      <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#details">
        <div class="accordion-body">
          <table class="table">
            <tr>
              <td>Number</td>
              <td><%= patient.addressHouseNumber %></td>
            </tr>
            <tr>
              <td>Line 1</td>
              <td><%= patient.addressLineOne %></td>
            </tr>
            <tr>
              <td>Line 2</td>
              <td><%= patient.addressLineTwo %></td>
            </tr>
            <tr>
              <td>City</td>
              <td><%= patient.addressCity %></td>
            </tr>
            <tr>
              <td>Post Code</td>
              <td><%= patient.addressPostcode %></td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </div>

  <label for="patientNotes">Important Notes:</label>
  <textarea id="patientNotes" aria-readonly="true" rows="5" style="resize: none;" class="form-control"><%= patient.notes %></textarea>




<a href="/exam/add/<%= patient.id %>" class="btn btn-primary mt-3 mb-1"> Add Exam</a>

<div class="table-responsive">
  <table class="table table-striped table-hover">
    <thead class="thead-dark">
      <tr class="table-dark">
        <th>Exam Date</th>
        <th>Optometrist</th>
        <th>Exam ID</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% exams.forEach(exam => { %>
        <tr>
          <td><%= exam.dateOfVisit.toLocaleDateString('en-GB') %></td>
          <td><%= optoms.find(optom => optom._id == exam.performingOptometrist).name %></td>
          <td><%= exam.id %></td>
          <td>
            <a class="btn btn-outline-danger btn-sm" href="/patient/archive/<%= exam.id %>">Archive</a>
            <a class="btn btn-secondary btn-sm" href="/exam/view/<%= exam.id %>"> View </a>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>


<% } else { %>

    <h1>No patient selected</h1>

<% } %>
 
